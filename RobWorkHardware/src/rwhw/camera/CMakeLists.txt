SET(SUBSYS_NAME camera )
SET(SUBSYS_DESC "Library of drivers for different cameras" )
SET(SUBSYS_DEPS rw )

SET(build TRUE)
set(DEFAULT TRUE)
set(REASON) 
RW_SUBSYS_OPTION( build ${SUBSYS_NAME} ${SUBSYS_DESC} ${DEFAULT} ${REASON})
RW_SUBSYS_DEPEND( build ${SUBSYS_NAME} DEPS ${SUBSYS_DEPS} )
RW_ADD_DOC( ${SUBSYS_NAME} )

IF( build )
    MESSAGE(STATUS "RobWorkHardware: ${SUBSYS_NAME} component ENABLED")    

    SET(SRC_CPP ${RW_IO_USER_FILES} CameraFactory.cpp)
    SET(SRC_HPP CameraFactory.hpp)
    
    FIND_PACKAGE(CMU1394)
    IF(CMU1394_FOUND AND DEFINED MSVC) # currently CMU1394 is only supported by MSVC compiler
        MESSAGE(STATUS "RobWorkHardware: ${SUBSYS_NAME} - CMU1394 library found. ")
        LIST(APPEND SRC_CPP CMU1394Camera.cpp)
        LIST(APPEND SRC_HPP CMU1394Camera.hpp)
        INCLUDE_DIRECTORIES(${CMU1394_INCLUDE_DIRS})
    ELSE()
        MESSAGE(STATUS "RobWorkHardware: ${SUBSYS_NAME} - CMU1394 library NOT found. ")
    ENDIF()
    
    FIND_PACKAGE(CMU1394C)
    IF(CMU1394C_FOUND)
        MESSAGE(STATUS "RobWorkHardware: ${SUBSYS_NAME} - CMU1394C library found. ")
        LIST(APPEND SRC_CPP CMU1394Camera_c.cpp)
        LIST(APPEND SRC_HPP CMU1394Camera_c.hpp)
        INCLUDE_DIRECTORIES(${CMU1394C_INCLUDE_DIR})
    ELSE ()
        MESSAGE(STATUS "RobWorkHardware: ${SUBSYS_NAME} - CMU1394C library NOT found. ") 
    ENDIF()
     
    FIND_PACKAGE(DC1394)
    IF(DC1394_FOUND)
        MESSAGE(STATUS "RobWorkHardware: ${SUBSYS_NAME} - DC1394 library found. ")
        LIST(APPEND SRC_CPP DC1394Camera.cpp DC1394CameraFactory.cpp)
        LIST(APPEND SRC_HPP DC1394Camera.hpp DC1394CameraFactory.hpp)
        INCLUDE_DIRECTORIES(${DC1394_INCLUDE_DIR})
    ELSE ()
        MESSAGE(STATUS "RobWorkHardware: ${SUBSYS_NAME} - DC1394 library NOT found. ") 
    ENDIF()
    
    
    FIND_PACKAGE( OpenCV COMPONENTS CV CXCORE HIGHGUI CVCAM QUIET)
    IF( OpenCV_FOUND AND OpenCV_CVCAM_INCLUDE_DIR)
        MESSAGE(STATUS "RobWorkHardware: ${SUBSYS_NAME} - OpenCV library found. ") 
        LIST(APPEND SRC_CPP OpenCVCamera.cpp)
        LIST(APPEND SRC_HPP OpenCVCamera.hpp)
        INCLUDE_DIRECTORIES( ${OpenCV_INCLUDE_DIRS} )
    ELSE ()
        MESSAGE(STATUS "RobWorkHardware: ${SUBSYS_NAME} - OpenCV library NOT found. ") 
    ENDIF()
    
    RW_ADD_LIBRARY(rwhw_camera camera ${SRC_CPP} ${SRC_HPP} )
    TARGET_LINK_LIBRARIES(rwhw_camera PUBLIC ${ROBWORK_LIBRARIES} ${DC1394_LIBRARY})
    RW_ADD_INCLUDES(camera "rwhw/camera" ${SRC_HPP})
    set( ENV{ROBWORKHARDWARE_LIBRARIES} "$ENV{ROBWORKHARDWARE_LIBRARIES}rwhw_camera;")
    
ENDIF()
